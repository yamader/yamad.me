import{$ as b,q as R,u as E,v as N,c as V}from"./web.CISyNs9c.js";const T=Symbol("store-raw"),j=Symbol("store-node"),h=Symbol("store-has"),C=Symbol("store-self");function I(n){let e=n[b];if(!e&&(Object.defineProperty(n,b,{value:e=new Proxy(n,Y)}),!Array.isArray(n))){const o=Object.keys(n),s=Object.getOwnPropertyDescriptors(n);for(let f=0,i=o.length;f<i;f++){const t=o[f];s[t].get&&Object.defineProperty(n,t,{enumerable:s[t].enumerable,get:s[t].get.bind(e)})}}return e}function P(n){let e;return n!=null&&typeof n=="object"&&(n[b]||!(e=Object.getPrototypeOf(n))||e===Object.prototype||Array.isArray(n))}function g(n,e=new Set){let o,s,f,i;if(o=n!=null&&n[T])return o;if(!P(n)||e.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):e.add(n);for(let t=0,d=n.length;t<d;t++)f=n[t],(s=g(f,e))!==f&&(n[t]=s)}else{Object.isFrozen(n)?n=Object.assign({},n):e.add(n);const t=Object.keys(n),d=Object.getOwnPropertyDescriptors(n);for(let r=0,l=t.length;r<l;r++)i=t[r],!d[i].get&&(f=n[i],(s=g(f,e))!==f&&(n[i]=s))}return n}function a(n,e){let o=n[e];return o||Object.defineProperty(n,e,{value:o=Object.create(null)}),o}function S(n,e,o){if(n[e])return n[e];const[s,f]=V(o,{equals:!1,internal:!0});return s.$=f,n[e]=s}function X(n,e){const o=Reflect.getOwnPropertyDescriptor(n,e);return!o||o.get||!o.configurable||e===b||e===j||(delete o.value,delete o.writable,o.get=()=>n[b][e]),o}function z(n){N()&&S(a(n,j),C)()}function L(n){return z(n),Reflect.ownKeys(n)}const Y={get(n,e,o){if(e===T)return n;if(e===b)return o;if(e===E)return z(n),o;const s=a(n,j),f=s[e];let i=f?f():n[e];if(e===j||e===h||e==="__proto__")return i;if(!f){const t=Object.getOwnPropertyDescriptor(n,e);N()&&(typeof i!="function"||n.hasOwnProperty(e))&&!(t&&t.get)&&(i=S(s,e,i)())}return P(i)?I(i):i},has(n,e){return e===T||e===b||e===E||e===j||e===h||e==="__proto__"?!0:(N()&&S(a(n,h),e)(),e in n)},set(){return!0},deleteProperty(){return!0},ownKeys:L,getOwnPropertyDescriptor:X};function O(n,e,o,s=!1){if(!s&&n[e]===o)return;const f=n[e],i=n.length;o===void 0?(delete n[e],n[h]&&n[h][e]&&f!==void 0&&n[h][e].$()):(n[e]=o,n[h]&&n[h][e]&&f===void 0&&n[h][e].$());let t=a(n,j),d;if((d=S(t,e,f))&&d.$(()=>o),Array.isArray(n)&&n.length!==i){for(let r=n.length;r<i;r++)(d=t[r])&&d.$();(d=S(t,"length",i))&&d.$(n.length)}(d=t[C])&&d.$()}function W(n,e){const o=Object.keys(e);for(let s=0;s<o.length;s+=1){const f=o[s];O(n,f,e[f])}}function B(n,e){if(typeof e=="function"&&(e=e(n)),e=g(e),Array.isArray(e)){if(n===e)return;let o=0,s=e.length;for(;o<s;o++){const f=e[o];n[o]!==f&&O(n,o,f)}O(n,"length",s)}else W(n,e)}function K(n,e,o=[]){let s,f=n;if(e.length>1){s=e.shift();const t=typeof s,d=Array.isArray(n);if(Array.isArray(s)){for(let r=0;r<s.length;r++)K(n,[s[r]].concat(e),o);return}else if(d&&t==="function"){for(let r=0;r<n.length;r++)s(n[r],r)&&K(n,[r].concat(e),o);return}else if(d&&t==="object"){const{from:r=0,to:l=n.length-1,by:c=1}=s;for(let u=r;u<=l;u+=c)K(n,[u].concat(e),o);return}else if(e.length>1){K(n[s],e,[s].concat(o));return}f=n[s],o=[s].concat(o)}let i=e[0];typeof i=="function"&&(i=i(f,o),i===f)||s===void 0&&i==null||(i=g(i),s===void 0||P(f)&&P(i)&&!Array.isArray(i)?W(f,i):O(n,s,i))}function U(...[n,e]){const o=g(n||{}),s=Array.isArray(o),f=I(o);function i(...t){R(()=>{s&&t.length===1?B(o,t[0]):K(o,t)})}return[f,i]}function G(n,e){const o=Reflect.getOwnPropertyDescriptor(n,e);return!o||o.get||o.set||!o.configurable||e===b||e===j||(delete o.value,delete o.writable,o.get=()=>n[b][e],o.set=s=>n[b][e]=s),o}const J={get(n,e,o){if(e===T)return n;if(e===b)return o;if(e===E)return z(n),o;const s=a(n,j),f=s[e];let i=f?f():n[e];if(e===j||e===h||e==="__proto__")return i;if(!f){const t=Object.getOwnPropertyDescriptor(n,e),d=typeof i=="function";if(N()&&(!d||n.hasOwnProperty(e))&&!(t&&t.get))i=S(s,e,i)();else if(i!=null&&d&&i===Array.prototype[e])return(...r)=>R(()=>Array.prototype[e].apply(o,r))}return P(i)?H(i):i},has(n,e){return e===T||e===b||e===E||e===j||e===h||e==="__proto__"?!0:(N()&&S(a(n,h),e)(),e in n)},set(n,e,o){return R(()=>O(n,e,g(o))),!0},deleteProperty(n,e){return R(()=>O(n,e,void 0,!0)),!0},ownKeys:L,getOwnPropertyDescriptor:G};function H(n){let e=n[b];if(!e){Object.defineProperty(n,b,{value:e=new Proxy(n,J)});const o=Object.keys(n),s=Object.getOwnPropertyDescriptors(n),f=Object.getPrototypeOf(n),i=f!==null&&n!==null&&typeof n=="object"&&!Array.isArray(n)&&f!==Object.prototype;if(i){const t=Object.getOwnPropertyDescriptors(f);o.push(...Object.keys(t)),Object.assign(s,t)}for(let t=0,d=o.length;t<d;t++){const r=o[t];if(!(i&&r==="constructor")){if(s[r].get){const l=s[r].get.bind(e);Object.defineProperty(n,r,{get:l,configurable:!0})}if(s[r].set){const l=s[r].set;Object.defineProperty(n,r,{set:u=>R(()=>l.call(e,u)),configurable:!0})}}}}return e}function Z(n,e){const o=g(n||{});return H(o)}const q=Symbol("store-root");function _(n,e,o,s,f){const i=e[o];if(n===i)return;const t=Array.isArray(n);if(o!==q&&(!P(n)||!P(i)||t!==Array.isArray(i)||f&&n[f]!==i[f])){O(e,o,n);return}if(t){if(n.length&&i.length&&(!s||f&&n[0]&&n[0][f]!=null)){let l,c,u,w,A,y,M,$;for(u=0,w=Math.min(i.length,n.length);u<w&&(i[u]===n[u]||f&&i[u]&&n[u]&&i[u][f]===n[u][f]);u++)_(n[u],i,u,s,f);const D=new Array(n.length),F=new Map;for(w=i.length-1,A=n.length-1;w>=u&&A>=u&&(i[w]===n[A]||f&&i[w]&&n[A]&&i[w][f]===n[A][f]);w--,A--)D[A]=i[w];if(u>A||u>w){for(c=u;c<=A;c++)O(i,c,n[c]);for(;c<n.length;c++)O(i,c,D[c]),_(n[c],i,c,s,f);i.length>n.length&&O(i,"length",n.length);return}for(M=new Array(A+1),c=A;c>=u;c--)y=n[c],$=f&&y?y[f]:y,l=F.get($),M[c]=l===void 0?-1:l,F.set($,c);for(l=u;l<=w;l++)y=i[l],$=f&&y?y[f]:y,c=F.get($),c!==void 0&&c!==-1&&(D[c]=i[l],c=M[c],F.set($,c));for(c=u;c<n.length;c++)c in D?(O(i,c,D[c]),_(n[c],i,c,s,f)):O(i,c,n[c])}else for(let l=0,c=n.length;l<c;l++)_(n[l],i,l,s,f);i.length>n.length&&O(i,"length",n.length);return}const d=Object.keys(n);for(let l=0,c=d.length;l<c;l++)_(n[d[l]],i,d[l],s,f);const r=Object.keys(i);for(let l=0,c=r.length;l<c;l++)n[r[l]]===void 0&&O(i,r[l],void 0)}function x(n,e={}){const{merge:o,key:s="id"}=e,f=g(n);return i=>{if(!P(i)||!P(f))return f;const t=_(f,{[q]:i},q,o,s);return t===void 0?i:t}}export{Z as a,U as c,x as r};
